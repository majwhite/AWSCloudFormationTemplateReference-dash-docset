<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <div id="main-content" class="awsui-util-container">
            <div id="main-col-body">
               <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
               <awsdocs-table-manager id="awsdocs-table-manager"></awsdocs-table-manager>
               <h1 class="topictitle" id="aws-resource-secretsmanager-rotationschedule">AWS::SecretsManager::RotationSchedule</h1>
               <div class="awsdocs-page-header-container">
                  <awsdocs-page-header></awsdocs-page-header>
                  <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
               </div>
               <p>The <code class="code">AWS::SecretsManager::RotationSchedule</code> resource configures rotation for
                  a secret. You must have already configured the secret with the details of the database
                  or
                  service. If you define both the secret and the database or service in an AWS CloudFormation
                  template, then define the <a href="aws-resource-secretsmanager-secrettargetattachment.html">AWS::SecretsManager::SecretTargetAttachment</a> resource to populate the secret
                  with the connection details of the database or service before you attempt to configure
                  rotation.
               </p>
               <div class="awsdocs-note">
                  <div class="awsdocs-note-title">
                     <awsui-icon name="status-warning" variant="error"></awsui-icon><span>Important</span></div>
                  <div class="awsdocs-note-text">
                     <p>When you configure rotation for a secret, AWS CloudFormation automatically rotates
                        the secret one time. Be sure you configure all your clients to retrieve the secret
                        using
                        Secrets Manager before configuring rotation to prevent breaking them.
                     </p>
                  </div>
               </div>
               <h2 id="aws-resource-secretsmanager-rotationschedule-syntax">Syntax</h2>
               <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
               <div id="JSON" name="JSON" class="section langfilter">
                  <h3 id="aws-resource-secretsmanager-rotationschedule-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;Type&quot; : &quot;AWS::SecretsManager::RotationSchedule&quot;,
  &quot;Properties&quot; : <span>{</span>
      &quot;<a href="#cfn-secretsmanager-rotationschedule-rotationlambdaarn">RotationLambdaARN</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-secretsmanager-rotationschedule-rotationrules">RotationRules</a>&quot; : <code class="replaceable"><a href="./aws-properties-secretsmanager-rotationschedule-rotationrules.html">RotationRules</a></code>,
      &quot;<a href="#cfn-secretsmanager-rotationschedule-secretid">SecretId</a>&quot; : <code class="replaceable">String</code>
    }
}
</code></pre></div>
               <div id="YAML" name="YAML" class="section langfilter">
                  <h3 id="aws-resource-secretsmanager-rotationschedule-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::SecretsManager::RotationSchedule
Properties: 
  <a href="#cfn-secretsmanager-rotationschedule-rotationlambdaarn">RotationLambdaARN</a>: <code class="replaceable">String</code>
  <a href="#cfn-secretsmanager-rotationschedule-rotationrules">RotationRules</a>: <code class="replaceable">
    <a href="./aws-properties-secretsmanager-rotationschedule-rotationrules.html">RotationRules</a></code>
  <a href="#cfn-secretsmanager-rotationschedule-secretid">SecretId</a>: <code class="replaceable">String</code>
</code></pre></div>
               <h2 id="aws-resource-secretsmanager-rotationschedule-properties">Properties</h2>
               <div class="variablelist">
                  <dl>
                     <dt><a id="cfn-secretsmanager-rotationschedule-rotationlambdaarn"></a><span class="term"><code class="code">RotationLambdaARN</code></span></dt>
                     <dd>
                        
                        <p>Specifies the ARN of the Lambda function that can rotate the secret. If you don&apos;t
                           specify this parameter, then the secret must already have the ARN of a Lambda function
                           configured. To reference a Lambda function also created in this template, use the
                           <a href="https://docs.aws.amazon.com/url-doc-domain/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a> function with the function&apos;s logical ID.
                        </p>
                        
                        <p><em>Required</em>: No
                        </p>
                        <p><em>Type</em>: String
                        </p>
                        <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                     </dd>
                     <dt><a id="cfn-secretsmanager-rotationschedule-rotationrules"></a><span class="term"><code class="code">RotationRules</code></span></dt>
                     <dd>
                        
                        <p>Specifies a structure that defines the rotation schedule for this secret.</p>
                        
                        <p><em>Required</em>: No
                        </p>
                        <p><em>Type</em>: <a href="./aws-properties-secretsmanager-rotationschedule-rotationrules.html">RotationRules</a></p>
                        <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                     </dd>
                     <dt><a id="cfn-secretsmanager-rotationschedule-secretid"></a><span class="term"><code class="code">SecretId</code></span></dt>
                     <dd>
                        
                        <p>Specifies the ARN or the friendly name of the secret that you want to rotate. To
                           reference a secret also created in this template, use the <a href="https://docs.aws.amazon.com/url-doc-domain/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a> function with the secret&apos;s logical ID.
                        </p>
                        
                        <p><em>Required</em>: Yes
                        </p>
                        <p><em>Type</em>: String
                        </p>
                        <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                     </dd>
                  </dl>
               </div>
               <h2 id="aws-resource-secretsmanager-rotationschedule-return-values">Return Values</h2>
               <h3 id="aws-resource-secretsmanager-rotationschedule-return-values-ref">Ref</h3>
               <p>When you pass the logical ID of an <code class="code">AWS::SecretsManager::RotationSchedule</code>
                  resource to the intrinsic <code class="code">Ref</code> function, the function returns the ARN of the
                  secret being configured, such as:
               </p>
               <p><em>arn:aws:secretsmanager:
                     us-west-2</em>:<em>123456789012</em>:secret:<em>my-path/my-secret-name</em>-<em>1a2b3c</em>
                  
               </p>
               <p>This enables you to reference a secret that you create in one part of the stack template
                  from within the definition of another resource later, in the same template. You typically
                  do this when you define the <a href="aws-resource-secretsmanager-secrettargetattachment.html">AWS::SecretsManager::SecretTargetAttachment</a> resource type.
               </p>
               <p>For more information about using the <code class="code">Ref</code> function, see <a href="https://docs.aws.amazon.com/url-doc-domain/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a>. 
               </p>
               <h2 id="aws-resource-secretsmanager-rotationschedule--examples">Examples</h2>
               <p>The following examples display complete examples of creating a secret, creating
                  an RDS database instance associated with the secret and configuring rotation. The
                  example shows how to define a Lambda rotation function, attach the required trust
                  and
                  permissions policies, and associate the function with the secret on a defined
                  schedule.
               </p>
               <p>RDS Secret Rotation</p>
               <h3 id="aws-resource-secretsmanager-rotationschedule--examples--Configuring_RDS_DB_Secret_Rotation">Configuring RDS DB Secret Rotation</h3>
               <div id="JSON" name="JSON" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--Configuring_RDS_DB_Secret_Rotation--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
      &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
      &quot;Transform&quot;: &quot;AWS::Serverless-2016-10-31&quot;,
      &quot;Resources&quot;: <span>{</span>
        &quot;MyRDSInstanceRotationSecret&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::Secret&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;Description&quot;: &quot;A Secrets Manager secret for my RDS DB instance&quot;,
            &quot;GenerateSecretString&quot;: <span>{</span>
              &quot;SecretStringTemplate&quot;: &quot;<span>{</span>\&quot;username\&quot;: \&quot;admin\&quot;}&quot;,
              &quot;GenerateStringKey&quot;: &quot;password&quot;,
              &quot;PasswordLength&quot;: 16,
              &quot;ExcludeCharacters&quot;: &quot;\&quot;@/\\&quot;
            }
          }
        },
        &quot;SecretRDSInstanceAttachment&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyRDSInstanceRotationSecret&quot;},
            &quot;TargetId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyDBInstance&quot;},
            &quot;TargetType&quot;: &quot;AWS::RDS::DBInstance&quot;
          }
        },
        &quot;MyDBInstance&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::RDS::DBInstance&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;AllocatedStorage&quot;: 20,
            &quot;DBInstanceClass&quot;: &quot;db.t2.micro&quot;,
            &quot;Engine&quot;: &quot;mysql&quot;,
            &quot;MasterUsername&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRDSInstanceRotationSecret}::username}}&quot;},
            &quot;MasterUserPassword&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRDSInstanceRotationSecret}::password}}&quot;},
            &quot;BackupRetentionPeriod&quot;: 0
          }
        },
        &quot;MySecretRotationSchedule&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::RotationSchedule&quot;,
          &quot;DependsOn&quot;: &quot;SecretRDSInstanceAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyRDSInstanceRotationSecret&quot;},
            &quot;RotationLambdaARN&quot;: <span>{</span>&quot;Fn::GetAtt&quot;: [&quot;MyRotationServerlessApp&quot;,&quot;Outputs.RotationLambdaARN&quot;]},
            &quot;RotationRules&quot;: <span>{</span>
              &quot;AutomaticallyAfterDays&quot;: 30
            }
          }
        },
        &quot;MyRotationServerlessApp&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::Serverless::Application&quot;,
          &quot;Properties&quot;:<span>{</span>
            &quot;Location&quot;: <span>{</span>
              &quot;ApplicationId&quot;: &quot;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerRDSMySQLRotationSingleUser&quot;,
              &quot;SemanticVersion&quot;: &quot;1.1.0&quot;
            },
            &quot;Parameters&quot;: <span>{</span>
              &quot;endpoint&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&quot;},
              &quot;functionName&quot;: &quot;SecretsManagerMySQLRotationLambda&quot;
            }
          }
        }
      }
    }</code></pre></div>
               <div id="YAML" name="YAML" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--Configuring_RDS_DB_Secret_Rotation--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
    Transform: AWS::Serverless-2016-10-31
    Description: &quot;This is an example template to demonstrate CloudFormation resources for Secrets Manager&quot;
    Resources:
      #This is a Secret resource with a randomly generated password in its SecretString JSON.
      MyRDSInstanceRotationSecret:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: &apos;This is my rds instance secret&apos;
          GenerateSecretString:
            SecretStringTemplate: &apos;<span>{</span>&quot;username&quot;: &quot;admin&quot;}&apos;
            GenerateStringKey: &apos;password&apos;
            PasswordLength: 16
            ExcludeCharacters: &apos;&quot;@/\&apos;
          Tags:
            -
              Key: AppName
              Value: MyApp
     
      #This is an RDS instance resource. Its master username and password use dynamic references to resolve values from
      #SecretsManager. The dynamic reference guarantees that CloudFormation will not log or persist the resolved value
      #We sub the Secret resource&apos;s logical id in order to construct the dynamic reference, since the Secret&apos;s name is being
      #generated by CloudFormation
      MyDBInstance:
        Type: AWS::RDS::DBInstance
        Properties:
          AllocatedStorage: 20
          DBInstanceClass: db.t2.micro
          Engine: mysql
          MasterUsername: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRDSInstanceRotationSecret}::username}}&apos;
          MasterUserPassword: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRDSInstanceRotationSecret}::password}}&apos;
          BackupRetentionPeriod: 0
     
      #This is a SecretTargetAttachment resource which updates the referenced Secret resource with properties about
      #the referenced RDS instance
      SecretRDSInstanceAttachment:
        Type: AWS::SecretsManager::SecretTargetAttachment
        Properties:
          SecretId: !Ref MyRDSInstanceRotationSecret
          TargetId: !Ref MyDBInstance
          TargetType: AWS::RDS::DBInstance
     
      #This is a RotationSchedule resource. It configures rotation of password for the referenced secret using a rotation lambda
      #The first rotation happens at resource creation time, with subsequent rotations scheduled according to the rotation rules
      #We explicitly depend on the SecretTargetAttachment resource being created to ensure that the secret contains all the
      #information necessary for rotation to succeed
      MySecretRotationSchedule:
        Type: AWS::SecretsManager::RotationSchedule
        DependsOn: SecretRDSInstanceAttachment
        Properties:
          SecretId: !Ref MyRDSInstanceRotationSecret
          RotationLambdaARN: !GetAtt MyRotationServerlessApp.Outputs.RotationLambdaARN
          RotationRules:
            AutomaticallyAfterDays: 30
     
      # This is a AWS::Serverless::Application resource. The Location property is hardcoded to use the SecretsManager team&apos;s
      # MySQL single user rotation. The resource creates an IAM role and a Lambda function which uses the role. The Lambda function
      # is passed as the rotation lambda ref to the RotationSchedule resource
      MyRotationServerlessApp:
        Type: AWS::Serverless::Application
        Properties:
          Location:
            ApplicationId: &apos;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerRDSMySQLRotationSingleUser&apos;
            SemanticVersion: 1.1.0
          Parameters:
            endpoint: !Sub &apos;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&apos;
            functionName: SecretsManagerMySQLRotationLambda</code></pre></div>
               <h3 id="aws-resource-secretsmanager-rotationschedule--examples--Redshift_Cluster_Secret_Rotation_Example">Redshift Cluster Secret Rotation Example</h3>
               <div id="JSON" name="JSON" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--Redshift_Cluster_Secret_Rotation_Example--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
      &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
      &quot;Transform&quot;: &quot;AWS::Serverless-2016-10-31&quot;,
      &quot;Resources&quot;: <span>{</span>
        &quot;MyRedshiftSecret&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::Secret&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;Description&quot;: &quot;This is a Secrets Manager secret for a Redshift cluster&quot;,
            &quot;GenerateSecretString&quot;: <span>{</span>
              &quot;SecretStringTemplate&quot;: &quot;<span>{</span>\&quot;username\&quot;: \&quot;admin\&quot;}&quot;,
              &quot;GenerateStringKey&quot;: &quot;password&quot;,
              &quot;PasswordLength&quot;: 16,
              &quot;ExcludeCharacters&quot;: &quot;\&quot;&apos;@/\\&quot;
            }
          }
        },
        &quot;MyRedshiftCluster&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::Redshift::Cluster&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;DBName&quot;: &quot;myjsondb&quot;,
            &quot;MasterUsername&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRedshiftSecret}::username}}&quot;},
            &quot;MasterUserPassword&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRedshiftSecret}::password}}&quot;},
            &quot;NodeType&quot;: &quot;ds2.xlarge&quot;,
            &quot;ClusterType&quot;: &quot;single-node&quot;
          }
        },
        &quot;SecretRedshiftAttachment&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyRedshiftSecret&quot;},
            &quot;TargetId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyRedshiftCluster&quot;},
            &quot;TargetType&quot;: &quot;AWS::Redshift::Cluster&quot;
          }
        },
        &quot;MySecretRotationSchedule&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::RotationSchedule&quot;,
          &quot;DependsOn&quot;: &quot;SecretRedshiftAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyRedshiftSecret&quot;},
            &quot;RotationLambdaARN&quot;: <span>{</span>&quot;Fn::GetAtt&quot;: [&quot;MyRotationServerlessApp&quot;,&quot;Outputs.RotationLambdaARN&quot;]},
            &quot;RotationRules&quot;: <span>{</span>
              &quot;AutomaticallyAfterDays&quot;: 30
            }
          }
        },
        &quot;MyRotationServerlessApp&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::Serverless::Application&quot;,
          &quot;Properties&quot;:<span>{</span>
            &quot;Location&quot;: <span>{</span>
              &quot;ApplicationId&quot;: &quot;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerRedshiftRotationSingleUser&quot;,
              &quot;SemanticVersion&quot;: &quot;1.1.0&quot;
            },
            &quot;Parameters&quot;: <span>{</span>
              &quot;endpoint&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&quot;},
              &quot;functionName&quot;: &quot;SecretsManagerRedshiftRotationLambda&quot;
            }
          }
        }
      }
    }</code></pre></div>
               <div id="YAML" name="YAML" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--Redshift_Cluster_Secret_Rotation_Example--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
    Transform: AWS::Serverless-2016-10-31
    Description: &quot;This is an example template to demonstrate CloudFormation resources for Secrets Manager&quot;
    Resources:
      #This is a Secret resource with a randomly generated password in its SecretString JSON.
      MyRedshiftSecret:
        Type: &quot;AWS::SecretsManager::Secret&quot;
        Properties:
          Description: &quot;This is a Secrets Manager secret for an Redshift cluster&quot;
          GenerateSecretString:
            SecretStringTemplate: &apos;<span>{</span>&quot;username&quot;: &quot;admin&quot;}&apos;
            GenerateStringKey: &quot;password&quot;
            PasswordLength: 16
            ExcludeCharacters: &quot;\&quot;@&apos;/\\&quot;
     
      # This is a Redshift cluster resource. The master username and password use dynamic references
      # to resolve values from Secrets Manager. The dynamic reference guarantees that CloudFormation
      # will not log or persist the resolved value. We use a Ref to the secret resource&apos;s logical id
      # to construct the dynamic reference, since the secret name is generated by CloudFormation.
      MyRedshiftCluster:
        Type: AWS::Redshift::Cluster
        Properties:
          DBName: &quot;myyamldb&quot;
          MasterUsername: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRedshiftSecret}::username}}&apos;
          MasterUserPassword: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyRedshiftSecret}::password}}&apos;
          NodeType: &quot;ds2.xlarge&quot;
          ClusterType: &quot;single-node&quot;
     
      # This is a SecretTargetAttachment resource which updates the referenced Secret resource with properties about
      # the referenced Redshift cluster
      SecretRedshiftAttachment:
        Type: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;
        Properties:
          SecretId: !Ref MyRedshiftSecret
          TargetId: !Ref MyRedshiftCluster
          TargetType: AWS::Redshift::Cluster
     
      #This is a RotationSchedule resource. It configures rotation of password for the referenced secret using a rotation lambda
      #The first rotation happens at resource creation time, with subsequent rotations scheduled according to the rotation rules
      #We explicitly depend on the SecretTargetAttachment resource being created to ensure that the secret contains all the
      #information necessary for rotation to succeed
      MySecretRotationSchedule:
        Type: AWS::SecretsManager::RotationSchedule
        DependsOn: SecretRedshiftAttachment
        Properties:
          SecretId: !Ref MyRedshiftSecret
          RotationLambdaARN: !GetAtt MyRotationServerlessApp.Outputs.RotationLambdaARN
          RotationRules:
            AutomaticallyAfterDays: 30
     
      # This is a AWS::Serverless::Application resource. The Location property is hardcoded to use the SecretsManager team&apos;s
      # MySQL single user rotation. The resource creates an IAM role and a Lambda function which uses the role. The Lambda function
      # is passed as the rotation lambda ref to the RotationSchedule resource
      MyRotationServerlessApp:
        Type: AWS::Serverless::Application
        Properties:
          Location:
            ApplicationId: &apos;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerRedshiftRotationSingleUser&apos;
            SemanticVersion: 1.1.0
          Parameters:
            endpoint: !Sub &apos;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&apos;
            functionName: SecretsManagerRedshiftRotationLambda</code></pre></div>
               <h3 id="aws-resource-secretsmanager-rotationschedule--examples--DocumentDB_Cluster_Secret_Rotation_Example">DocumentDB Cluster Secret Rotation Example</h3>
               <div id="JSON" name="JSON" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--DocumentDB_Cluster_Secret_Rotation_Example--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">    <span>{</span>
      &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
      &quot;Transform&quot;: &quot;AWS::Serverless-2016-10-31&quot;,
      &quot;Resources&quot;: <span>{</span>
        &quot;MyDocDBClusterRotationSecret&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::Secret&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;Description&quot;: &quot;A Secrets Manager secret for my DocDB Cluster&quot;,
            &quot;GenerateSecretString&quot;: <span>{</span>
              &quot;SecretStringTemplate&quot;: &quot;<span>{</span>\&quot;username\&quot;: \&quot;someadmin\&quot;}&quot;,
              &quot;GenerateStringKey&quot;: &quot;password&quot;,
              &quot;PasswordLength&quot;: 16,
              &quot;ExcludeCharacters&quot;: &quot;\&quot;@/&quot;
            }
          }
        },
        &quot;SecretDocDBClusterAttachment&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::SecretTargetAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyDocDBClusterRotationSecret&quot;},
            &quot;TargetId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyDocDBCluster&quot;},
            &quot;TargetType&quot;: &quot;AWS::DocDB::DBCluster&quot;
          }
        },
        &quot;MyDocDBCluster&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::DocDB::DBCluster&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;MasterUsername&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyDocDBClusterRotationSecret}::username}}&quot;},
            &quot;MasterUserPassword&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyDocDBClusterRotationSecret}::password}}&quot;},
          }
        },
        &quot;MySecretRotationSchedule&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::SecretsManager::RotationSchedule&quot;,
          &quot;DependsOn&quot;: &quot;SecretDocDBClusterAttachment&quot;,
          &quot;Properties&quot;: <span>{</span>
            &quot;SecretId&quot;: <span>{</span>&quot;Ref&quot;: &quot;MyDocDBClusterRotationSecret&quot;},
            &quot;RotationLambdaARN&quot;: <span>{</span>&quot;Fn::GetAtt&quot;: [&quot;MyRotationServerlessApp&quot;,&quot;Outputs.RotationLambdaARN&quot;]},
            &quot;RotationRules&quot;: <span>{</span>
              &quot;AutomaticallyAfterDays&quot;: 30
            }
          }
        },
        &quot;MyRotationServerlessApp&quot;: <span>{</span>
          &quot;Type&quot;: &quot;AWS::Serverless::Application&quot;,
          &quot;Properties&quot;:<span>{</span>
            &quot;Location&quot;: <span>{</span>
              &quot;ApplicationId&quot;: &quot;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerMongoDBRotationSingleUser&quot;,
              &quot;SemanticVersion&quot;: &quot;1.1.0&quot;
            },
            &quot;Parameters&quot;: <span>{</span>
              &quot;endpoint&quot;: <span>{</span>&quot;Fn::Sub&quot;: &quot;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&quot;},
              &quot;functionName&quot;: &quot;SecretsManagerDocDBRotationLambda&quot;
            }
          }
        }
      }
    }</code></pre></div>
               <div id="YAML" name="YAML" class="section langfilter">
                  <h4 id="aws-resource-secretsmanager-rotationschedule--examples--DocumentDB_Cluster_Secret_Rotation_Example--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
    Transform: AWS::Serverless-2016-10-31
    Description: &quot;This is an example template to demonstrate CloudFormation resources for Secrets Manager&quot;
    Resources:
      #This is a Secret resource with a randomly generated password in its SecretString JSON.
      MyDocDBClusterRotationSecret:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: &apos;This is my DocDB cluster secret&apos;
          GenerateSecretString:
            SecretStringTemplate: &apos;<span>{</span>&quot;username&quot;: &quot;someadmin&quot;}&apos;
            GenerateStringKey: &apos;password&apos;
            PasswordLength: 16
            ExcludeCharacters: &apos;&quot;@/&apos;
          Tags:
            -
              Key: AppName
              Value: MyApp
     
      #This is an DocDB cluster resource. Its master username and password use dynamic references to resolve values from
      #SecretsManager. The dynamic reference guarantees that CloudFormation will not log or persist the resolved value
      #We sub the Secret resource&apos;s logical id in order to construct the dynamic reference, since the Secret&apos;s name is being
      #generated by CloudFormation
      MyDocDBCluster:
        Type: AWS::DocDB::DBCluster
        Properties:
          MasterUsername: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyDocDBClusterRotationSecret}::username}}&apos;
          MasterUserPassword: !Sub &apos;<span>{</span><span>{</span>resolve:secretsmanager:$<span>{</span>MyDocDBClusterRotationSecret}::password}}&apos;
     
      #This is a SecretTargetAttachment resource which updates the referenced Secret resource with properties about
      #the referenced DocDB cluster
      SecretDocDBClusterAttachment:
        Type: AWS::SecretsManager::SecretTargetAttachment
        Properties:
          SecretId: !Ref MyDocDBClusterRotationSecret
          TargetId: !Ref MyDocDBCluster
          TargetType: AWS::DocDB::DBCluster
     
      #This is a RotationSchedule resource. It configures rotation of password for the referenced secret using a rotation lambda
      #The first rotation happens at resource creation time, with subsequent rotations scheduled according to the rotation rules
      #We explicitly depend on the SecretTargetAttachment resource being created to ensure that the secret contains all the
      #information necessary for rotation to succeed
      MySecretRotationSchedule:
        Type: AWS::SecretsManager::RotationSchedule
        DependsOn: SecretDocDBClusterAttachment
        Properties:
          SecretId: !Ref MyDocDBClusterRotationSecret
          RotationLambdaARN: !GetAtt MyRotationServerlessApp.Outputs.RotationLambdaARN
          RotationRules:
            AutomaticallyAfterDays: 30
     
      # This is a AWS::Serverless::Application resource. The Location property is hardcoded to use the SecretsManager team&apos;s
      # MongoDB single user rotation. The resource creates an IAM role and a Lambda function which uses the role. The Lambda function
      # is passed as the rotation lambda ref to the RotationSchedule resource
      MyRotationServerlessApp:
        Type: AWS::Serverless::Application
        Properties:
          Location:
            ApplicationId: &apos;arn:aws:serverlessrepo:us-east-1:297356227824:applications/SecretsManagerMongoDBRotationSingleUser&apos;
            SemanticVersion: 1.1.0
          Parameters:
            endpoint: !Sub &apos;https://secretsmanager.$<span>{</span>AWS::Region}.amazonaws.com&apos;
            functionName: SecretsManagerDocDBRotationLambda</code></pre></div>
               <h2 id="aws-resource-secretsmanager-rotationschedule--seealso">See Also</h2>
               <div class="itemizedlist">
                   
                   
                  
                  <ul class="itemizedlist" type="disc">
                     <li class="listitem">
                        
                        <p>
                           <a href="https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_RotateSecret.html">RotateSecret</a> in the AWS Secrets Manager API Reference
                        </p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>
                           <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html">Rotating Your AWS
                              Secrets Manager Secrets</a> in the AWS Secrets Manager User Guide
                        </p>
                        
                     </li>
                  </ul>
               </div>
               <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
            </div>
            <noscript>
               <div>
                  <div>
                     <div>
                        <div id="js_error_message">
                           <p><img src="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/%0A                              https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png%0A                            " alt="Warning"> <strong>Javascript is disabled or is unavailable in your
                                 browser.</strong></p>
                           <p>To use the AWS Documentation, Javascript must be
                              enabled. Please refer to your browser&apos;s Help pages for instructions.
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
            </noscript>
            
            <awsdocs-page-utilities></awsdocs-page-utilities>
         </div></div>
</body>
</html>