<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="aws-resource-cfn-customresource">AWS::CloudFormation::CustomResource</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>In a CloudFormation template, you use the <code class="code">AWS::CloudFormation::CustomResource</code>
                                    or <code class="code">Custom::<em>String</em>
                                       </code> resource type to specify custom resources.
                                 </p>
                                 <p>Custom resources provide a way for you to write custom provisioning logic in
                                    CloudFormation template and have CloudFormation run it during a stack operation, such
                                    as when
                                    you create, update or delete a stack. For more information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html">Custom
                                       resources</a>.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>If you use the <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">VPC endpoints</a> feature, custom resources in the VPC must have access to
                                          CloudFormation-specific Amazon Simple Storage Service (Amazon S3) buckets. Custom
                                          resources
                                          must send responses to a pre-signed Amazon S3 URL. If they can&apos;t send responses to
                                          Amazon
                                          S3, CloudFormation won&apos;t receive a response and the stack operation fails. For more
                                          information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-vpce-bucketnames.html">Setting up VPC
                                             endpoints for AWS CloudFormation</a>.
                                       </p>
                                    </div>
                                 </div>
                                 <h2 id="aws-resource-cfn-customresource-syntax">Syntax</h2>
                                 <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h3 id="aws-resource-cfn-customresource-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;Type&quot; : &quot;AWS::CloudFormation::CustomResource&quot;,
  &quot;Properties&quot; : <span>{</span>
      &quot;<a href="#cfn-customresource-servicetoken">ServiceToken</a>&quot; : <code class="replaceable">String</code>
    }
}
</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h3 id="aws-resource-cfn-customresource-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::CloudFormation::CustomResource
Properties: 
  <a href="#cfn-customresource-servicetoken">ServiceToken</a>: <code class="replaceable">String</code>
</code></pre></div>
                                 <h2 id="aws-resource-cfn-customresource-properties">Properties</h2>
                                 <div class="variablelist">
                                    <dl>
                                       <dt><a id="cfn-customresource-servicetoken"></a><span class="term"><code class="code">ServiceToken</code></span></dt>
                                       <dd>
                                          
                                          <div class="awsdocs-note">
                                             <div class="awsdocs-note-title">
                                                <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                             <div class="awsdocs-note-text">
                                                <p>Only one property is defined by AWS for a custom resource: <code class="code">ServiceToken</code>.
                                                   All other properties are defined by the service provider.
                                                </p>
                                             </div>
                                          </div>
                                          
                                          <p>The service token that was given to the template developer by the service provider
                                             to
                                             access the service, such as an Amazon SNS topic ARN or Lambda function ARN. The service
                                             token
                                             must be from the same region in which you are creating the stack.
                                          </p>
                                          
                                          <p>Updates are not supported.</p>
                                          
                                          
                                          <p><em>Required</em>: Yes
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                                       </dd>
                                    </dl>
                                 </div>
                                 <h2 id="aws-resource-cfn-customresource--remarks">Remarks</h2>
                                 <p>
                                    <em>Specifying custom resource type names</em>
                                    
                                 </p>
                                 <p>For custom resources, you can specify <code class="code">AWS::CloudFormation::CustomResource</code>
                                    as the resource type, or you can specify your own resource type name. For example,
                                    instead
                                    of using <code class="code">AWS::CloudFormation::CustomResource</code>, you can use
                                    <code class="code">Custom::MyCustomResourceTypeName</code>.
                                 </p>
                                 <p>Custom resource type names can include alphanumeric characters and the following
                                    characters: <code class="code">_@-</code>. You can specify a custom resource type name up to a maximum
                                    length of 60 characters. You cannot change the type during an update.
                                 </p>
                                 <p>Using your own resource type names helps you quickly differentiate the types of custom
                                    resources in your stack. For example, if you had two custom resources that conduct
                                    two
                                    different ping tests, you could name their type as <code class="code">Custom::PingTester</code> to make
                                    them easily identifiable as ping testers (instead of using
                                    <code class="code">AWS::CloudFormation::CustomResource</code>).
                                 </p>
                                 <p>
                                    <em>Replacing a custom resource during an update</em>
                                    
                                 </p>
                                 <p>You can update custom resources that require a replacement of the underlying physical
                                    resource. When you update a custom resource in a CloudFormation template, CloudFormation
                                    sends an update request to that custom resource. If the custom resource requires a
                                    replacement, the new custom resource must send a response with the new physical ID.
                                    When
                                    CloudFormation receives the response, it compares the <code class="code">PhysicalResourceId</code>
                                    between the old and new custom resources. If they are different, CloudFormation recognizes
                                    the update as a replacement and sends a delete request to the old resource. For a
                                    step-by-step walkthrough of this process, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html#crpg-walkthrough-stack-updates">Stack updates</a>. 
                                 </p>
                                 <p>Note the following: </p>
                                 <div class="itemizedlist">
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>You can monitor the progress of the update in the Events tab. For more information,
                                             see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-view-stack-data-resources.html">Viewing stack data and resources</a>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>For more information about resource behavior during updates, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html">AWS
                                                CloudFormation stacks updates</a>.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 <p>
                                    <em>Retrieving return values</em>
                                    
                                 </p>
                                 <p>For a custom resource, return values are defined by the custom resource provider,
                                    and
                                    are retrieved by calling Fn::GetAtt on the provider-defined attributes.
                                 </p>
                                 <h2 id="aws-resource-cfn-customresource--examples">Examples</h2>
                                 <h3 id="aws-resource-cfn-customresource--examples--Creating_a_custom_resource_definition_in_a_template">Creating a custom resource definition in a template</h3>
                                 <p>The following example demonstrates how to create a custom resource definition in a
                                    template.
                                 </p>
                                 <p>All properties other than <code class="code">ServiceToken</code>, and all <code class="code">Fn::GetAtt</code>
                                    resource attributes, are defined by the custom resource provider.
                                 </p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h4 id="aws-resource-cfn-customresource--examples--Creating_a_custom_resource_definition_in_a_template--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;AWSTemplateFormatVersion&quot; : &quot;2010-09-09&quot;,
  &quot;Resources&quot; : <span>{</span>
    &quot;MyFrontEndTest&quot; : <span>{</span>
      &quot;Type&quot;: &quot;Custom::PingTester&quot;,
      &quot;Version&quot; : &quot;1.0&quot;,
      &quot;Properties&quot; : <span>{</span>
        &quot;ServiceToken&quot;: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;,
        &quot;key1&quot; : &quot;string&quot;,
        &quot;key2&quot; : [ &quot;list&quot; ],
        &quot;key3&quot; : <span>{</span> &quot;key4&quot; : &quot;map&quot; }
      }
    }
  },
  &quot;Outputs&quot; : <span>{</span>
    &quot;CustomResourceAttribute1&quot; : <span>{</span>
      &quot;Value&quot; : <span>{</span> &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey1&quot;] }
    },
    &quot;CustomResourceAttribute2&quot; : <span>{</span>
      &quot;Value&quot; : <span>{</span> &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey2&quot;] }
    }
  }
}</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h4 id="aws-resource-cfn-customresource--examples--Creating_a_custom_resource_definition_in_a_template--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: &quot;2010-09-09&quot;
Resources: 
  MyFrontEndTest: 
    Type: &quot;Custom::PingTester&quot;
    Version: &quot;1.0&quot;
    Properties: 
      ServiceToken: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;
      key1: string
      key2: 
        - list
      key3: 
        key4: map
Outputs: 
  CustomResourceAttribute1: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey1
  CustomResourceAttribute2: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey2</code></pre></div>
                                 <h3 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_function_in_a_custom_resource">Using an AWS Lambda function in a custom resource</h3>
                                 <p>With Lambda functions and custom resources, you can run custom code in response to
                                    stack events (create, update, and delete). The following custom resource invokes a
                                    Lambda
                                    function and sends it the StackName property as input. The function uses this property
                                    to
                                    get outputs from the appropriate stack.
                                 </p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h4 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_function_in_a_custom_resource--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">&quot;MyCustomResource&quot; : <span>{</span>
  &quot;Type&quot; : &quot;Custom::TestLambdaCrossStackRef&quot;,
  &quot;Properties&quot; : <span>{</span>
    &quot;ServiceToken&quot;: <span>{</span> &quot;Fn::Join&quot;: [ &quot;&quot;, [ &quot;arn:aws:lambda:&quot;, <span>{</span> &quot;Ref&quot;: &quot;AWS::Region&quot; }, &quot;:&quot;, <span>{</span> &quot;Ref&quot;: &quot;AWS::AccountId&quot; }, &quot;:function:&quot;, <span>{</span>&quot;Ref&quot; : &quot;LambdaFunctionName&quot;} ] ] },
    &quot;StackName&quot;: <span>{</span>
      &quot;Ref&quot;: &quot;NetworkStackName&quot;
    }
  }
}</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h4 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_function_in_a_custom_resource--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">MyCustomResource: 
  Type: &quot;Custom::TestLambdaCrossStackRef&quot;
  Properties: 
    ServiceToken:
      !Sub arn:aws:lambda:$<span>{</span>AWS::Region}:$<span>{</span>AWS::AccountId}:function:$<span>{</span>LambdaFunctionName}
    StackName: 
      Ref: &quot;NetworkStackName&quot;</code></pre></div>
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning"> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the AWS Documentation, Javascript must be
                                                enabled. Please refer to your browser&apos;s Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div></div>
</body>
</html>