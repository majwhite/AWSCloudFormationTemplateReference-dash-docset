<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="aws-resource-as-lifecyclehook">AWS::AutoScaling::LifecycleHook</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>The AWS::AutoScaling::LifecycleHook resource specifies lifecycle hooks for an Auto
                                    Scaling
                                    group. These hooks enable an Auto Scaling group to be aware of events in the Auto
                                    Scaling
                                    instance lifecycle, and then perform a custom action when the corresponding lifecycle
                                    event
                                    occurs. A lifecycle hook provides a specified amount of time (one hour by default)
                                    to complete
                                    the lifecycle action before the instance transitions to the next state. 
                                 </p>
                                 <p>There are two types of lifecycle hooks that can be implemented: launch lifecycle hooks
                                    and
                                    termination lifecycle hooks. Use a launch lifecycle hook to prepare instances for
                                    use or to
                                    delay instances from registering behind the load balancer before their configuration
                                    has been
                                    applied completely. Use a termination lifecycle hook to prepare running instances
                                    to be shut
                                    down. 
                                 </p>
                                 <p>For more information, see <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/lifecycle-hooks.html">Amazon EC2 Auto Scaling lifecycle
                                       hooks</a> in the <em>Amazon EC2 Auto Scaling User Guide</em> and <a href="https://docs.aws.amazon.com/autoscaling/ec2/APIReference/API_PutLifecycleHook.html">PutLifecycleHook</a> in the
                                    <em>Amazon EC2 Auto Scaling API Reference</em>.
                                 </p>
                                 <h2 id="aws-resource-as-lifecyclehook-syntax">Syntax</h2>
                                 <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h3 id="aws-resource-as-lifecyclehook-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;Type&quot; : &quot;AWS::AutoScaling::LifecycleHook&quot;,
  &quot;Properties&quot; : <span>{</span>
      &quot;<a href="#cfn-as-lifecyclehook-autoscalinggroupname">AutoScalingGroupName</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-defaultresult">DefaultResult</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-heartbeattimeout">HeartbeatTimeout</a>&quot; : <code class="replaceable">Integer</code>,
      &quot;<a href="#cfn-autoscaling-lifecyclehook-lifecyclehookname">LifecycleHookName</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-lifecycletransition">LifecycleTransition</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-notificationmetadata">NotificationMetadata</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-notificationtargetarn">NotificationTargetARN</a>&quot; : <code class="replaceable">String</code>,
      &quot;<a href="#cfn-as-lifecyclehook-rolearn">RoleARN</a>&quot; : <code class="replaceable">String</code>
    }
}
</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h3 id="aws-resource-as-lifecyclehook-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::AutoScaling::LifecycleHook
Properties: 
  <a href="#cfn-as-lifecyclehook-autoscalinggroupname">AutoScalingGroupName</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-defaultresult">DefaultResult</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-heartbeattimeout">HeartbeatTimeout</a>: <code class="replaceable">Integer</code>
  <a href="#cfn-autoscaling-lifecyclehook-lifecyclehookname">LifecycleHookName</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-lifecycletransition">LifecycleTransition</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-notificationmetadata">NotificationMetadata</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-notificationtargetarn">NotificationTargetARN</a>: <code class="replaceable">String</code>
  <a href="#cfn-as-lifecyclehook-rolearn">RoleARN</a>: <code class="replaceable">String</code>
</code></pre></div>
                                 <h2 id="aws-resource-as-lifecyclehook-properties">Properties</h2>
                                 <div class="variablelist">
                                    <dl>
                                       <dt><a id="cfn-as-lifecyclehook-autoscalinggroupname"></a><span class="term"><code class="code">AutoScalingGroupName</code></span></dt>
                                       <dd>
                                          
                                          <p>The name of the Auto Scaling group for the lifecycle hook.</p>
                                          
                                          <p><em>Required</em>: Yes
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-defaultresult"></a><span class="term"><code class="code">DefaultResult</code></span></dt>
                                       <dd>
                                          
                                          <p>The action the Auto Scaling group takes when the lifecycle hook timeout elapses or
                                             if an
                                             unexpected failure occurs. The valid values are <code class="code">CONTINUE</code> and <code class="code">ABANDON</code>
                                             (default).
                                          </p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-heartbeattimeout"></a><span class="term"><code class="code">HeartbeatTimeout</code></span></dt>
                                       <dd>
                                          
                                          <p>The maximum time, in seconds, that can elapse before the lifecycle hook times out.
                                             The
                                             range is from <code class="code">30</code> to <code class="code">7200</code> seconds. The default value is <code class="code">3600</code> seconds (1 hour). If the
                                             lifecycle hook times out, Amazon EC2 Auto Scaling performs the action that you specified
                                             in
                                             the <code class="code">DefaultResult</code> property.
                                          </p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: Integer
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                       <dt><a id="cfn-autoscaling-lifecyclehook-lifecyclehookname"></a><span class="term"><code class="code">LifecycleHookName</code></span></dt>
                                       <dd>
                                          
                                          <p>The name of the lifecycle hook.</p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Minimum</em>: <code class="code">1</code></p>
                                          <p><em>Maximum</em>: <code class="code">255</code></p>
                                          <p><em>Pattern</em>: <code class="code">[A-Za-z0-9\-_\/]+</code></p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-lifecycletransition"></a><span class="term"><code class="code">LifecycleTransition</code></span></dt>
                                       <dd>
                                          
                                          <p>The instance state to which you want to attach the lifecycle hook. The valid values
                                             are:
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>autoscaling:EC2_INSTANCE_LAUNCHING</p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>autoscaling:EC2_INSTANCE_TERMINATING</p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                          <p><em>Required</em>: Yes
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-notificationmetadata"></a><span class="term"><code class="code">NotificationMetadata</code></span></dt>
                                       <dd>
                                          
                                          <p>Additional information that is included any time Amazon EC2 Auto Scaling sends a message
                                             to the notification target.
                                          </p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Minimum</em>: <code class="code">1</code></p>
                                          <p><em>Maximum</em>: <code class="code">1023</code></p>
                                          <p><em>Pattern</em>: <code class="code">[\u0020-\uD7FF\uE000-\uFFFD\uD800\uDC00-\uDBFF\uDFFF\r\n\t]*</code></p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-notificationtargetarn"></a><span class="term"><code class="code">NotificationTargetARN</code></span></dt>
                                       <dd>
                                          
                                          <p>The Amazon Resource Name (ARN) of the notification target that Amazon EC2 Auto Scaling
                                             uses to notify you when an instance is in the transition state for the lifecycle hook.
                                             You can
                                             specify an Amazon SQS queue or an Amazon SNS topic. The notification message includes
                                             the
                                             following information: lifecycle action token, user account ID, Auto Scaling group
                                             name,
                                             lifecycle hook name, instance ID, lifecycle transition, and notification metadata.
                                             
                                          </p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                       <dt><a id="cfn-as-lifecyclehook-rolearn"></a><span class="term"><code class="code">RoleARN</code></span></dt>
                                       <dd>
                                          
                                          <p>The ARN of the IAM role that allows the Auto Scaling group to publish to the specified
                                             notification target, for example, an Amazon SNS topic or an Amazon SQS queue. For
                                             information
                                             about creating this role, see <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/configuring-lifecycle-hook-notifications.html">Configuring a notification target for a lifecycle hook</a> in the <em>Amazon EC2 Auto Scaling User
                                                Guide</em>.
                                          </p>
                                          
                                          <p><em>Required</em>: No
                                          </p>
                                          <p><em>Type</em>: String
                                          </p>
                                          <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                                       </dd>
                                    </dl>
                                 </div>
                                 <h2 id="aws-resource-as-lifecyclehook-return-values">Return values</h2>
                                 <h3 id="aws-resource-as-lifecyclehook-return-values-ref">Ref</h3>
                                 <p>When the logical ID of this resource is provided to the <code class="code">Ref</code> intrinsic
                                    function, <code class="code">Ref</code> returns the resource name. For example:
                                    <code class="code">mylifecyclehook</code>.
                                 </p>
                                 <p>For more information about using the <code class="code">Ref</code> function, see <a href="intrinsic-function-reference-ref.html">Ref</a>.
                                    
                                 </p>
                                 <h2 id="aws-resource-as-lifecyclehook--examples">Examples</h2>
                                 <p>The following examples specify lifecycle hooks. </p>
                                 <p>For examples of CloudFormation stack templates with lifecycle hooks, see our <a href="https://github.com/aws-samples/amazon-ec2-auto-scaling-group-examples" rel="noopener noreferrer" target="_blank"><span>GitHub
                                          repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. Included are examples of launch lifecycle hooks that work with a user
                                    data script that is defined in the Auto Scaling group&apos;s launch template.
                                 </p>
                                 <h3 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_termination">Lifecycle hook for instance termination</h3>
                                 <p>The following example specifies a lifecycle hook that supports a custom action at
                                    instance termination. It uses the <code class="code">Ref</code> intrinsic function to refer to an Auto
                                    Scaling group (whose logical name is <code class="code">myASG</code>) that is declared elsewhere in the
                                    same template. It uses the <code class="code">NotificationMetadata</code> property to specify
                                    additional information to be sent with the notification, such as the name of the cluster
                                    to which the instance belongs.
                                 </p>
                                 <p>This snippet does not include the Lambda/EventBridge rule resources that would need
                                    to
                                    exist or be created to complete the configuration. For information
                                    about creating these resources, see <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/configuring-lifecycle-hook-notifications.html">Configuring a notification target for a lifecycle hook</a> in the <em>Amazon EC2 Auto Scaling User
                                       Guide</em>.
                                 </p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h4 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_termination--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;myTerminationLifecycleHook&quot;:<span>{</span>
    &quot;Type&quot;:&quot;AWS::AutoScaling::LifecycleHook&quot;,
    &quot;Properties&quot;:<span>{</span>
      &quot;AutoScalingGroupName&quot;:<span>{</span>
        &quot;Ref&quot;:&quot;myASG&quot;
      },
      &quot;LifecycleTransition&quot;:&quot;autoscaling:EC2_INSTANCE_TERMINATING&quot;,
      &quot;HeartbeatTimeout&quot;: 300,
      &quot;DefaultResult&quot;: &quot;CONTINUE&quot;,
      &quot;NotificationMetadata&quot;: &quot;optional metadata&quot;
    }
  }
}</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h4 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_termination--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">---
myTerminationLifecycleHook: 
  Type: AWS::AutoScaling::LifecycleHook
  Properties: 
    AutoScalingGroupName: 
      Ref: myASG
    LifecycleTransition: &quot;autoscaling:EC2_INSTANCE_TERMINATING&quot;
    HeartbeatTimeout: 300
    DefaultResult: &quot;CONTINUE&quot;
    NotificationMetadata: &quot;optional metadata&quot;</code></pre></div>
                                 <h3 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_launch">Lifecycle hook for instance launch</h3>
                                 <p>The following example specifies a lifecycle hook that supports a custom action at
                                    instance launch. The lifecycle hook is added to a new Auto Scaling group that&apos;s created
                                    from the same snippet.
                                 </p>
                                 <p>This example solution uses the <code class="code">NotificationTargetARN</code> and
                                    <code class="code">RoleARN</code> properties to specify the Amazon SQS queue and IAM role to use to
                                    receive notification when a lifecycle action occurs. This snippet does not include
                                    the
                                    Amazon SQS queue and IAM role resources that would need to exist or be created to
                                    complete
                                    the configuration. For information
                                    about creating these resources, see <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/configuring-lifecycle-hook-notifications.html">Configuring a notification target for a lifecycle hook</a> in the <em>Amazon EC2 Auto Scaling User
                                       Guide</em>.
                                 </p>
                                 <div id="JSON" name="JSON" class="section langfilter">
                                    <h4 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_launch--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Parameters&quot;:<span>{</span>
    &quot;Subnets&quot;:<span>{</span>
      &quot;Type&quot;:&quot;CommaDelimitedList&quot;
    }
  },
  &quot;Resources&quot;:<span>{</span>
    &quot;myASG&quot;:<span>{</span>
      &quot;Type&quot;:&quot;AWS::AutoScaling::AutoScalingGroup&quot;,
      &quot;Properties&quot;:<span>{</span>
        &quot;DesiredCapacity&quot;:&quot;2&quot;,
        &quot;MaxSize&quot;:&quot;3&quot;,
        &quot;MinSize&quot;:&quot;1&quot;,
        &quot;LaunchTemplate&quot;: <span>{</span>
          &quot;LaunchTemplateId&quot;: <span>{</span>
            &quot;Ref&quot;:&quot;myLaunchTemplate&quot;
          },
          &quot;Version&quot;:<span>{</span>
            &quot;Ref&quot;:&quot;myLaunchTemplateVersionNumber&quot;
          }
        },
        &quot;VPCZoneIdentifier&quot;:<span>{</span>
          &quot;Ref&quot;:&quot;Subnets&quot;
        },
        &quot;LifecycleHookSpecificationList&quot;:[
          <span>{</span>
            &quot;LifecycleTransition&quot;:&quot;autoscaling:EC2_INSTANCE_LAUNCHING&quot;,
            &quot;LifecycleHookName&quot;:&quot;myLaunchLifecycleHook&quot;,
            &quot;HeartbeatTimeout&quot;:4800,
            &quot;NotificationTargetARN&quot;:<span>{</span>
              &quot;Fn::GetAtt&quot;:[
                &quot;SQS&quot;,
                &quot;Arn&quot;
              ]
            },
            &quot;RoleArn&quot;:<span>{</span>
              &quot;Fn::Join&quot;:[
                &quot;:&quot;,
                [
                  &quot;arn:aws:iam:&quot;,
                  <span>{</span>
                    &quot;Ref&quot;:&quot;AWS::AccountId&quot;
                  },
                  &quot;role/role-name&quot;
                ]
              ]
            }
          }
        ]
      }
    },
    &quot;SQS&quot;:<span>{</span>
      &quot;Type&quot;:&quot;AWS::SQS::Queue&quot;
    }
  }
}</code></pre></div>
                                 <div id="YAML" name="YAML" class="section langfilter">
                                    <h4 id="aws-resource-as-lifecyclehook--examples--Lifecycle_hook_for_instance_launch--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
Parameters:
  Subnets:
    Type: CommaDelimitedList
  AZs:
    Type: CommaDelimitedList
Resources:
  myASG:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      DesiredCapacity: &apos;2&apos;
      MaxSize: &apos;3&apos;
      MinSize: &apos;1&apos;
      LaunchTemplate:
        LaunchTemplateId: !Ref myLaunchTemplate
        Version: !Ref myLaunchTemplateVersionNumber
      VPCZoneIdentifier: !Ref Subnets
      LifecycleHookSpecificationList:
        - LifecycleTransition: &quot;autoscaling:EC2_INSTANCE_LAUNCHING&quot;
          LifecycleHookName: &quot;myLaunchLifecycleHook&quot;
          HeartbeatTimeout: 4800
          NotificationTargetARN: !GetAtt SQS.Arn
          RoleARN: !Join 
            - &apos;:&apos;
            - - &apos;arn:aws:iam:&apos;
              - !Ref &apos;AWS::AccountId&apos;
              - role/role-name
  SQS:
    Type: AWS::SQS::Queue</code></pre></div>
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning"> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the Amazon Web Services Documentation, Javascript must be
                                                enabled. Please refer to your browser&apos;s Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div></div>
</body>
</html>